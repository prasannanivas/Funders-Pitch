{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { Component } from \"react\";\nimport Layout from \"../../components/Layout\";\nimport { Form, Button, Input } from \"semantic-ui-react\";\nimport Campaign from \"../../ethereum/campaign\";\nimport web3 from \"../../ethereum/web3\";\nimport { Link, Router } from \"../../routes\";\n\nclass Newrequest extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      description: \"\",\n      value: \"\",\n      recipient: \"\",\n      message: \"\",\n      isloading: false\n    };\n    this.submitHandler = this.submitHandler.bind(this);\n  }\n\n  static async getInitialProps(props) {\n    return {\n      address: props.query.address\n    };\n  }\n\n  async submitHandler(evt) {\n    evt.preventDefault();\n    this.setState({\n      isloading: true\n    });\n    const campaign = Campaign(this.props.address);\n    const {\n      description,\n      value,\n      recipient\n    } = this.state;\n\n    try {\n      const accounts = await web3.eth.getAccounts();\n      await campaign.methods.createRequest(description, web3.utils.toWei(value, \"ether\"), recipient).send({\n        from: accounts[0]\n      });\n    } catch (error) {\n      this.setState({\n        message: error.message,\n        isloading: false\n      });\n      return;\n    }\n\n    this.setState({\n      isloading: false\n    });\n    Router.pushRoute(`/campaigns/show/${this.props.address}/request`);\n  }\n\n  render() {\n    return __jsx(Layout, null, __jsx(Link, {\n      primary: true,\n      route: `/campaigns/show/${this.props.address}/request`\n    }, __jsx(\"a\", null, \" \", __jsx(Button, {\n      color: \"vk\",\n      size: \"mini\"\n    }, `<-  go back`), \" \")), __jsx(Form, {\n      className: \"text-center\",\n      onSubmit: this.submitHandler\n    }, __jsx(Form.Field, null, __jsx(\"label\", null, \"Description\"), __jsx(Input, {\n      onChange: evt => {\n        this.setState({\n          description: evt.target.value\n        });\n      },\n      value: this.state.description\n    })), __jsx(Form.Field, null, __jsx(\"label\", null, \"Value\"), __jsx(Input, {\n      label: \"ether\",\n      labelPosition: \"right\",\n      onChange: evt => {\n        this.setState({\n          value: evt.target.value\n        });\n      },\n      value: this.state.value,\n      type: \"number\"\n    })), __jsx(Form.Field, null, __jsx(\"label\", null, \"Recipient\"), __jsx(Input, {\n      onChange: evt => {\n        this.setState({\n          recipient: evt.target.value\n        });\n      },\n      value: this.state.recipient\n    })), __jsx(Button, {\n      color: \"teal\",\n      loading: this.state.isloading\n    }, \"Submit\"), __jsx(\"h1\", {\n      className: \"font-bold text-2xl text-red-400\"\n    }, this.state.message)));\n  }\n\n}\n\nexport default Newrequest;","map":null,"metadata":{},"sourceType":"module"}